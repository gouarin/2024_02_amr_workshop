<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/theme/light.css" id="theme">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous">

    <title>Samurai - Workshop Block-structured AMR @Exascale - February
      2024</title>
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <div class="row">
            <div class="col-8">
              <img src="/figures/logo.png">
            </div>
            <div class="col-4 align-self-center text-end">
              <h1 class="title-talk">Samurai</h1>
              <p class="subtitle-talk">Block-structured AMR @Exascale</p>
              <p class="mt-4 mb-0"><small>Loïc Gouarin</small></p>
              <p class="mt-0"><small>7 February 2024</small></p>
            </div>
          </div>
          <div>
            <img width="60px" src="/figures/by.png" />
            <span style="font-size: 10px">This work is licensed under a Creative
              Commons Attribution 4.0 International License</span>
          </div>
        </section>

        <section data-menu-title="Context">
          <section>
            <h1>Context</h1>
            <hr>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Mesh adaptation</h1>
              </div>
              <div class="main">
                <div class="row">
                  <div class="col">
                    <img id="adapt" src="/light/figures/patch_based.png">
                  </div>
                  <div class="col">
                    <img id="adapt" src="/light/figures/cell_based.png">
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <!-- <h1 class="title">AMR characteristics</h1> -->
              </div>
              <div class="main text-center">
                <img width="80%" id="adapt" src="/light/figures/amr-charac.png">
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Open source software</h1>
              </div>
              <div class="main text-center">
                <table style="font-size: 20px;">
                  <tr>
                    <th class="text-center">Name</th>
                    <th class="text-center">Data structure</th>
                    <th class="text-center">Adaptation criteria</th>
                    <th class="text-center">Time scheme</th>
                    <th class="text-center">Load balancing</th>
                  </tr>
                  <tr>
                    <td class="text-center">AMReX</td>
                    <td class="text-center">block</td>
                    <td class="text-center">heuristic</td>
                    <td class="text-center">global/local</td>
                    <td class="text-center">SFC</td>
                  </tr>
                  <tr>
                    <td class="text-center">Dendro</td>
                    <td class="text-center">tree</td>
                    <td class="text-center">wavelet</td>
                    <td class="text-center">global</td>
                    <td class="text-center">SFC</td>
                  </tr>
                  <tr>
                    <td class="text-center">Dyablo</td>
                    <td class="text-center">tree</td>
                    <td class="text-center">heuristic</td>
                    <td class="text-center">global</td>
                    <td class="text-center">SFC</td>
                  </tr>
                  <tr>
                    <td class="text-center">Peano</td>
                    <td class="text-center">tree</td>
                    <td class="text-center">-</td>
                    <td class="text-center">-</td>
                    <td class="text-center">SFC</td>
                  </tr>
                  <tr>
                    <td class="text-center">P4est</td>
                    <td class="text-center">tree</td>
                    <td class="text-center">-</td>
                    <td class="text-center">-</td>
                    <td class="text-center">SFC</td>
                  </tr>
                  <tr>
                    <td class="text-center">samurai</td>
                    <td class="text-center">interval</td>
                    <td class="text-center">heuristic/wavelet</td>
                    <td
                      class="text-center"><p
                        class="mb-0"><span>RK/splitting/IMEX</span></p>
                      <p class="mt-0"><span>time-space/code
                          coupling</span></p></td>
                    <td class="text-center"><span>SFC/
                        diffusion algorithm</span></td>
                  </tr>
                </table>

                <div class="pt-5 fragment">
                  <i class="text-center"><span>samurai: create a unified
                      framework for testing a whole range of mesh
                      adaptation methods with the latest generation of numerical
                      schemes.</span></i>
                </div>
              </div>
            </div>
          </section>
        </section>

        <section data-menu-title="Context">
          <section>
            <h1>Samurai</h1>
            <hr>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Design principles</h1>
              </div>
              <div class="main">
                <ul>
                  <li>Mesh compression according to the level</li>
                  <li>Achieve fast look-up for a cell into the structure</li>
                  <li>Maximize the memory contiguity of the stored data</li>
                  <li>Facilitate inter-level operations</li>
                  <li>Give the possibility of writing numerical schemes
                    easily</li>
                </ul>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">An overview of the data structure</h1>
              </div>
              <div class="main">
                <div class="row">
                  <div class="col-5 align-self-center">
                    <img src="figures/2d_example.png">
                  </div>
                  <div class="col-7 text-center align-self-center">
                    <span class="interval_symb">[</span>
                    <span class="interval_bound">start</span>
                    <span class="interval_symb">,</span>
                    <span class="interval_bound">end</span>
                    <span class="interval_symb">[ @ </span>
                    <span class="interval_offset">offset</span>
                    <span class="interval_symb">:</span>
                    <span class="interval_step">step</span>

                  </div>
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">An overview of the data structure</h1>
              </div>
              <div class="main">
                <div class="row">
                  <div class="col-4 align-self-center">
                    <img src="figures/2d_example.png">
                  </div>
                  <div
                    class="col-3 fragment align-self-center border border-2 p-2"
                    data-fragment-index="1">
                    <ul class="myclass">
                      <li class="color_0"><strong>Level 0</strong></li>
                      <ul>
                        <li>y: 0 <span>&#8594;</span> [0, 4[</li>
                        <li>y: 1 <span>&#8594;</span> [0, 1[, [3, 4[</li>
                        <li>y: 2 <span>&#8594;</span> [0, 1[, [3, 4[</li>
                        <li>y: 3 <span>&#8594;</span> [0, 3[</li>
                      </ul>

                      <li class="color_1"><strong>Level 1</strong></li>
                      <ul>
                        <li>y: 2 <span>&#8594;</span> [2, 6[</li>
                        <li>y: 3 <span>&#8594;</span> [2, 6[</li>
                        <li>y: 4 <span>&#8594;</span> [2, 4[, [5, 6[</li>
                        <li>y: 5 <span>&#8594;</span> [2, 6[</li>
                        <li>y: 6 <span>&#8594;</span> [6, 8[</li>
                        <li>y: 7 <span>&#8594;</span> [6, 7[</li>
                      </ul>

                      <li class="color_2"><strong>Level 2</strong></li>
                      <ul>
                        <li>y: 8 <span>&#8594;</span> [8, 10[</li>
                        <li>y: 9 <span>&#8594;</span> [8, 10[</li>
                        <li>y: 14 <span>&#8594;</span> [14, 16[</li>
                        <li>y: 15 <span>&#8594;</span> [14, 16[</li>
                      </ul>
                    </ul>
                    <div class="text-center fragment" data-fragment-index="4">
                      <span class="caveat">cell list</span>
                    </div>
                  </div>
                  <div
                    class="col-4 fragment  align-self-center border border-2 m-2 p-2"
                    data-fragment-index="2">

                    <ul class="myclass">
                      <li class="color_0"><strong>Level 0</strong></li>
                      <ul>
                        <li>x: [0, 4[, [0, 1[, [3, 4[, [0, 1[, [3, 4[, [0,
                          3[</li>
                        <li>y: [0, 4[ <span class="fragment"
                            data-fragment-index="3">@0</span></li>
                        <li>y-offset: [0, 1, 3, 5, 6]</li>
                      </ul>
                      <li class="color_1"><strong>Level 1</strong></li>
                      <ul>
                        <li>x: [2, 6[, [2, 6[, [2, 4[, [5, 6[, [2, 6[, [6, 8[,
                          [6, 7[</li>
                        <li>y: [2, 8[<span class="fragment"
                            data-fragment-index="3">@-2</span></li>
                        <li>y-offset = [0, 1, 2, 4, 5, 6, 7]</li>
                      </ul>
                      <li class="color_2"><strong>Level 2</strong></li>
                      <ul>
                        <li>x: [8, 10[, [8, 10[, [14, 16[, [14, 16[</li>
                        <li>y: [8, 10[<span class="fragment"
                            data-fragment-index="3">@-8</span>, [14, 16[<span
                            class="fragment"
                            data-fragment-index="3">@-12</span></li>
                        <li>y-offset: [0, 1, 2, 3, 4]</li>
                      </ul>
                    </ul>
                    <div class="text-center fragment" data-fragment-index="4">
                      <span class="caveat">cell array</span>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">An overview of the data structure</h1>
              </div>
              <div class="main">
                <div class="row">
                  <div class="col-5 align-self-center">
                    <img src="figures/2d_example_numbering.png">
                  </div>
                  <div class="col align-self-center border border-2 p-2">
                    <ul class="myclass">
                      <li class="color_0"><strong>Level 0</strong></li>
                      <ul>
                        <li>x: [0, 4[ <span>@ 0</span>, [0, 1[ <span>@ 4</span>,
                          [3, 4[ <span>@ 2</span>, [0, 1[ <span>@ 6</span>,
                          [3,
                          4[ <span>@ 4</span>, [0, 3[ <span>@ 4</span></li>
                        <li>y: [0, 4[ <span>@ 0</span></li>
                        <li>y-offset: [0, 1, 3, 5, 6]</li>
                      </ul>

                      <li class="color_1"><strong>Level 1</strong></li>
                      <ul>
                        <li>x: [2, 6[ <span>@ 9</span>, [2, 6[ <span>@
                            13</span>,
                          [2, 4[ <span>@ 17</span>, [5, 6[ <span>@ 16</span>,
                          [2, 6[ <span>@ 20</span>, [6, 8[ <span>@ 20</span>,
                          [6, 7[ <span>@ 22</span></li>
                        <li>y: [2, 8[ <span>@ -2</span></li>
                        <li>y-offset : [0, 1, 2, 4, 5, 6, 7]</li>
                      </ul>

                      <li class="color_2"><strong>Level 2</strong></li>
                      <ul>
                        <li>x: [8, 10[ <span>@ 21</span>, [8, 10[ <span>@
                            23</span>,
                          [14, 16[ <span>@ 19</span>, [14, 16[ <span>@
                            21</span></li>
                        <li>y: [8, 10[ <span>@ -8</span>, [14, 16[ <span>@
                            -12</span></li>
                        <li>y-offset: [0, 1, 2, 3, 4]</li>
                      </ul>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Mesh constraints</h1>
              </div>
              <div class="main">
                <ul>
                  <li>A refined cell is split into 2 in 1d, 4
                    in 2d and 8 in 3d equal parts.</li>
                  <li>At a given resolution level, the size of
                    the cells is equal.</li>
                  <li>The size of the cells is defined by the
                    resolution level.</li>
                  $$\Delta x = 2^{-level}$$
                  <li>A cell is represented by integer
                    coordinates given its location.</li>
                  $$center = \Delta x (indices + 0.5)$$
                  <li>The adapted mesh is generally graded.</li>
                </ul>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Identify the different types of cells</h1>
              </div>
              <div class="main text-center">
                <video id="adapt" data-autoplay
                  src="/light/videos/identify_0000.mp4" />
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Identify the different types of cells</h1>
              </div>
              <div class="main text-center">
                <video id="adapt" data-autoplay
                  src="/light/videos/identify_0001.mp4" />
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Identify the different types of cells</h1>
              </div>
              <div class="main text-center">
                <video id="adapt" data-autoplay
                  src="/light/videos/identify_0002.mp4" />
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Identify the different types of cells</h1>
              </div>
              <div class="main text-center">
                <video id="adapt" data-autoplay
                  src="/light/videos/identify_0003.mp4" />
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Algebra of sets</h1>
              </div>
              <div class="main text-center">
                <div>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh.png" />
                  <span>&#8899;</span>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh_ghost.png" />
                </div>
                <span>=</span>
                <div>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh_all.png" />
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Algebra of sets</h1>
              </div>
              <div class="main text-center">
                <div>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh_all.png" />
                  <span>\</span>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh.png" />
                </div>
                <span>=</span>
                <div>
                  <img class="border border-2" width="400px" data-autoplay
                    src="/figures/mesh_ghost.png" />
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Algebra of sets</h1>
              </div>
              <div class="main">
                <p>The search of an admissible set is recursive. The
                  algorithm starts from the last dimension (y in 2d, z in 3d,
                  …).</p>

                <p>The available operators in samurai are for now</p>
                <ul>
                  <li>the <span>intersection</span> of sets,</li>
                  <li>the <span>union</span> of sets,</li>
                  <li>the <span>difference</span> between two sets,</li>
                  <li>the <span>translation</span> of a set,</li>
                  <li>the <span>extension</span> of a set.</li>
                </ul>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Compression rates</h1>
              </div>
              <div class="main text-center">
                <img width="60%" src="figures/p4est_1.png">
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Compression rates</h1>
              </div>
              <div class="main">
                <table>
                  <tr>
                    <th>Level</th>
                    <th>Num. of cells</th>
                    <th>p4est</th>
                    <th>samurai (leaves)</th>
                    <th>samurai (all)</th>
                    <th>ratio</th>
                  </tr>
                  <tr>
                    <td>9</td>
                    <td>$66379$</td>
                    <td>$2.57$ Mb</td>
                    <td>$33.68$ Kb</td>
                    <td>$121$ Kb</td>
                    <td>$21.24$</td>
                  </tr>
                  <tr>
                    <td>10</td>
                    <td>$263767$</td>
                    <td>$10.25$ Mb</td>
                    <td>$66.64$ Kb</td>
                    <td>$236.8$ Kb</td>
                    <td>$43.28$</td>
                  </tr>
                  <tr>
                    <td>11</td>
                    <td>$1051747$</td>
                    <td>$40.96$ Mb</td>
                    <td>$132.36$ Kb</td>
                    <td>$467.24$ Kb</td>
                    <td>$87.66$</td>
                  </tr>
                  <tr>
                    <td>12</td>
                    <td>$4200559$</td>
                    <td>$163.75$ Mb</td>
                    <td>$263.6$ Kb</td>
                    <td>$927$ Kb</td>
                    <td>$176.64$</td>
                  </tr>
                  <tr>
                    <td>13</td>
                    <td>$16789627$</td>
                    <td>$654.86$ Mb</td>
                    <td>$525.9$ Kb</td>
                    <td>$1.85$ Mb</td>
                    <td>$353.98$</td>
                  </tr>
                  <tr>
                    <td>14</td>
                    <td>$67133575$</td>
                    <td>$2.61$ Gb</td>
                    <td>$1.05$ Mb</td>
                    <td>$3.68$ Mb</td>
                    <td>$709.24$</td>
                  </tr>
                </table>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Other features</h1>
              </div>
              <div class="main">
                <ul>
                  <li>Loop algorithms over the levels and the cells</li>
                  <li>Simplified access operator</li>
                  <li>Helper classes to construct complex meshes</li>
                  <li>Helper classes to construct schemes for explicit and
                    implicit usage</li>
                  <li>Helper classes to construct N-D operators and expressions
                    using xtensor</li>
                  <li>HDF5 support</li>
                </ul>
              </div>
            </div>
          </section>
        </section>

        <section data-menu-title="examples">
          <section>
            <h1>Examples</h1>
            <hr>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Field creation</h1>
              </div>
              <div class="main">
                <pre><code class="cpp data-trim data-noescape">auto mesh = samurai::MRMesh&lt;Config&gt;({{0, 0}, {1, 1}}, 2, 8);
auto u = samurai::make_field&lt;double, 1&gt;("u", mesh);

samurai::for_each_cell(mesh, [&](auto cell)
{
  auto x = cell.center(0);
  auto y = cell.center(1);

  u[cell] = x*x + y*y;
});
                </code></pre>
              </div>
            </div>
          </section>

          <section>
            <h1>The projection operator</h1>
            <hr>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">An example</h1>
              </div>
              <div class="main">
                <video id="adapt" data-autoplay
                  src="/light/videos/projection.mp4" />
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">The implementation</h1>
              </div>
              <div class="main">
                <pre><code class="cpp data-trim data-noescape" data-line-numbers="1|2-4|6-9">auto u = samurai::make_field&lt;double, 1&gt;("u", mesh);
...
auto set = samurai::intersection(mesh[level], mesh[level + 1])
          .on(level);

set([&](const auto& i, auto)
{
    u(level, i) = 0.5*(u(level + 1, 2*i) + u(level + 1, 2*i + 1));
});
                </code></pre>
              </div>
            </div>
          </section>

          <section>
            <h1>Creation of random meshes and their graduation</h1>
            <hr>
          </section>

          <section>
            <div class="row">
              <div class="col-6">
                <img src="/figures/graduation_before.png" />
                before
              </div>
              <div class="col-6">
                <img src="/figures/graduation_after.png" />
                after
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Create a mesh</h1>
              </div>
              <div class="main">
                <pre><code class="cpp">
constexpr std::size_t dim = 2;
std::size_t start_level = 1;
std::size_t max_refinement_level = 7;

samurai::Box&lt;int, dim&gt; box({0, 0}, {1&lt;&lt;start_level, 1&lt;&lt;start_level});

samurai::CellArray&lt;dim&gt; ca;
ca[start_level] = {start_level, box};
                  </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Add cells randomly</h1>
              </div>
              <div class="main">
                <pre><code class="cpp">
samurai::CellList&lt;dim&gt; cl;

samurai::for_each_interval(ca, [&](std::size_t level, const auto& interval, const auto& index)
{
    auto choice = xt::random::choice(xt::xtensor_fixed&lt;bool, xt::xshape&lt;2&gt;&gt;{true, false}, interval.size());

    for(int i = interval.start, ic = 0; i&lt;interval.end; ++i, ++ic)
    {
        if (choice[ic])
        {
            cl[level + 1][2*index].add_interval({2*i, 2*i+2});
            cl[level + 1][2*index + 1].add_interval({2*i, 2*i+2});
        }
        else
        {
            cl[level][index].add_point(i);
        }
    }
});

ca = {cl, true};
                  </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Tag cells to refine</h1>
              </div>
              <div class="main">
                <pre><code class="cpp">std::size_t min_level = ca.min_level(), max_level = ca.max_level();
xt::xtensor_fixed&lt;int, xt::xshape&lt;4, dim&gt;&gt; stencil{{1, 0}, {-1, 0}, {0, 1}, {0, -1}};

auto tag = samurai::make_field&lt;bool, 1&gt;("tag", ca);
tag.fill(false);

for(std::size_t level = min_level + 2; level &lt;= max_level; ++level)
{
    for(std::size_t level_below = min_level; level_below &lt; level - 1; ++level_below)
    {
        for(std::size_t i = 0; i &lt; stencil.shape()[0]; ++i)
        {
            auto s = xt::view(stencil, i);
            auto set = samurai::intersection(samurai::translate(ca[level], s), ca[level_below])
                      .on(level_below);
            set([&](const auto& i, const auto& index)
            {
                tag(level_below, i, index[0]) = true;
            });
        }
    }
}
                  </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Create a new mesh from the tag</h1>
              </div>
              <div class="main">
                <pre><code class="cpp">
samurai::CellList&lt;dim&gt; cl;

samurai::for_each_cell(ca, [&](auto cell)
{
    auto i = cell.indices[0];
    auto j = cell.indices[1];

    if (tag[cell])
    {
        cl[cell.level + 1][{2*j}].add_interval({2*i, 2*i+2});
        cl[cell.level + 1][{2*j + 1}].add_interval({2*i, 2*i+2});
    }
    else
    {
        cl[cell.level][{j}].add_point(i);
    }
});

samurai::CellArray&lt;dim&gt; new_ca = {cl, true};
                  </code></pre>
              </div>
            </div>
          </section>

          <section>
            <h1>The heat equation</h1>
            <hr>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">The problem</h1>
              </div>
              <div class="main">
                We consider the well known heat equation
                $$
                \frac{\partial u}{\partial t} - \Delta u =
                0
                $$
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">The finite volume scheme</h1>
              </div>
              <div class="main">
                Since we have

                $$
                \int_V \Delta u = \int_{\partial V} \nabla u\cdot \mathbf{n},
                $$

                the flux function to implement is a discrete version of
                $\nabla
                u\cdot \mathbf{n}$.
                Here, we choose the normal gradient of the first order,
                requiring a stencil of two cells.
                This is enough to write the static configuration

                <pre><code class="cpp data-trim data-noescape">auto u = samurai::make_field&lt;1&gt;("u", mesh); // scalar field

using cfg = samurai::FluxConfig&lt;SchemeType::LinearHomogeneous,
                                1,            // output_field_size
                                2,            // stencil_size
                                decltype(u)>; // input_field_type
                </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">The finite volume scheme</h1>
              </div>
              <div class="main">

                Now, denoting by $V_L$ (left) and $V_R$ (right) the stencil
                cells and $F$ their interface, the discrete flux from $V_L$ to
                $V_R$ writes

                $$
                \mathcal{F}_h(u_h)_{|F} := \frac{u_R-u_L}{h},
                $$
                where $u_L$ and $u_R$ are the finite volume approximations of
                $u$ in the respective cells, and $h$ is the cell length.

                The flux function then writes

                <pre><code class="cpp data-trim data-noescape">samurai::FluxDefinition&lt;cfg&gt; gradient([](double h)
{
    samurai::FluxStencilCoeffs&lt;cfg&gt; c;
    c[0] = -1/h; // left
    c[1] =  1/h; // right
    return c;
});

auto diff = samurai::make_flux_based_scheme(gradient);
          </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Simulation on uniform mesh</h1>
              </div>
              <div class="main">
                <pre><code class="cpp">...
auto diff = samurai::make_diffusion&lt;decltype(u)>();
auto id   = samurai::make_identity&lt;decltype(u)>();
for(std::size_t ite=0; ite&lt;200; ++ite)
{
    samurai::update_ghost_mr(u);

    if (explicit_scheme)
    {
        unp1 = u - dt * diff(u);
    }
    else
    {
        auto back_euler = id + dt * diff;
        // solves the linear equation   [Id + dt*Diff](unp1) = u
        samurai::petsc::solve(back_euler, unp1, u);
    }

    std::swap(u.array(), u_np1.array());

    samurai::save(fmt::format("mesh_{}", ite + 1), mesh, u);
}

                </code></pre>
              </div>
            </div>
          </section>

          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Simulation with adaptive mesh
                  refinement</h1>
              </div>
              <div class="main">
                <pre><code class="cpp" data-line-numbers="1-2,6-7">auto MRadaptation = samurai::make_MRAdapt(u);
double eps = 1e-4, regularity = 2;

for(std::size_t ite=0; ite&lt;200; ++ite)
{
    MRadaptation(eps, regularity);
    unp1.resize();
    samurai::update_ghost_mr(u);

    if (explicit_scheme)
    {
        unp1 = u - dt * diff(u);
    }
    else
    {
      auto back_euler = id + dt * diff;
      // solves the linear equation   [Id + dt*Diff](unp1) = u
      samurai::petsc::solve(back_euler, unp1, u);
    }

    std::swap(u.array(), u_np1.array());
    samurai::save(fmt::format("mesh_{}", ite + 1), mesh, u);
}
              </code></pre>
              </div>
            </div>
          </section>
          <section>
            <div class="sl-block">
              <div class="header">
                <h1 class="title">Key point</h1>
              </div>
              <div class="main text-center">
                <p>
                  Implement your finite volume scheme on a uniform cartesian
                  grid
                </p>
                <p>and</p>

                <p class="fragment"><span>you have explicit and implicit
                    at your disposal</span></p>
                <p class="fragment"><span>you have a large renage of time
                    schemes
                    available</span></p>
                <p class="fragment"><span>you have the adaptation (MRA / AMR)
                    without further effort
                  </span></p>
                <p class="fragment"><span>you have parallelism</span></p>
              </div>
            </div>
          </section>
        </section>

        <section>
          <div class="sl-block">
            <div class="header">
              <h1 class="title">Roadmap</h1>
            </div>
            <div class="main text-center">
              <img id="adapt" src="/light/figures/roadmap.png">
              <!--
              <ul>
                <li>Implement various finite volume schemes</li>
                <li>Implement various lattice Boltzmann schemes</li>
                <li>Implement various discontinuous Galerkin schemes</li>
                <li>Ponio integration</li>
                <li>Python and Fortran bindings</li>
                <li>Implement point-based multiresolution</li>
              </ul> -->
            </div>
          </div>
        </section>

        <section>
          <div class="sl-block">
            <div class="header">
              <h1 class="title">Roadmap in the NumPeX context</h1>
            </div>
            <div class="main">
              <ul>
                <li>Optimization</li>
                <li>Flexibility in term of container choice</li>
                <li>Parallel backends</li>
                <li>Load balancing using diffusion algorithm or space filling
                  curves</li>
                <li>GPU support</li>
                <li>IO optimization and compression</li>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <div class="sl-block">
            <div class="header">
              <h1 class="title">HPC@Maths</h1>
            </div>
            <div class="main" style="font-size: 20px">
              <p>samurai is part of the projects developed in the HPC@Maths
                team (5 permanent researchers, 5 research engineers, 11
                research
                associates, 6 PhD students, 1 Post-doc).</p>

              <p>The main goals of this team are</p>
              <img id="adapt" src="/light/figures/actions.png">
              <div class="text-center">
                <p>PI: L.G and M. Massot -
                  <a
                    href="https://initiative-hpc-maths.gitlab.labos.polytechnique.fr/site/index.html">HPC@Maths
                    website</a></p>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="sl-block">
            <div class="header">
              <h1 class="title">Scientific collaborations</h1>
            </div>
            <div class="main" style="font-size: 18px">
              <ul>
                <li><span>Lattice Boltzmann methods and multiresolution</span>
                  -
                  <strong>Thomas
                    Bellotti</strong> (IRMA/Université Strasbourg) and
                  <strong>Benjamin Graille</strong> (LMO/Université
                  Paris-Saclay)</li>
                <li><span>Plasma discharges and electric propulsion</span> -
                  <strong>Alejandro Alvarez</strong> (LPP/Ecole
                  polytechnique) and <strong>Louis
                    Reboul</strong> (ONERA)</li>
                <li><span>Direct numerical simulation of lithium-ion batteries
                    based
                    on high-resolution 3D images of porous electrode
                    microstructures</span> - <strong>Ali Asad</strong>
                  (TotalEnergies) and <strong>Laurent François</strong>
                  (ONERA)</li>
                <li><span>Sharp interface method for low Mach two-phase
                    flows</span> -
                  <strong>Nicolas Grenier</strong> (LISN/Université
                  Paris-Saclay) and <strong>Christian
                    Tenaud</strong> (EM2C/Université
                  Paris-Saclay)</li>
                <li><span>Low-Mach reactive flows</span> - <strong>Christian
                    Tenaud</strong> (EM2C/Université
                  Paris-Saclay)</li>
                <li><span>Interfacial flow simulation</span> -
                  <strong>Giuseppe
                    Orlando</strong> (CMAP/Ecole polytechnique) and
                  <strong>Marica Pelanti</strong> (ENSTA/IP Paris)</li>
                <li><span>Mathematical modeling and simulation of
                    non-equilibrium
                    plasmas for the prediction of electric propulsion</span> -
                  <strong>Zoubaïr Tazakkati</strong> (CMAP/Ecole
                  polytechnique)</li>
                <li><span>Simulation analysis on the Hydrogen risk</span> -
                  <strong>Luc Lecointre</strong>, <strong>Pierre-Alexandre
                    Masset</strong> (CEA) and <strong>Christian
                    Tenaud</strong> (EM2C/Université
                  Paris-Saclay)</li>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <div class="sl-block">
            <div class="header">
              <h1 class="title">Scientific collaborations: NumPEx program</h1>
            </div>
            <div class="main" style="font-size: 20px">
              <ul>
                <li>PhD with CEA and INRIA (ExaMA WP1)</li>
                <li>Engineer (ExaMA WP7)</li>
                <li>Post-doc with CEA (ExoDost) </li>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <div class="row align-items-center">
            <div class="col-4">
              <video data-autoplay loop="true"
                src="/figures/ink.mp4" />
            </div>
            <div class="col">
              <img src="./figures/human.png">
            </div>
            <div class="col-5">
              <img src="./figures/lbm_test_case.png">
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <video data-autoplay loop="true"
                src="/figures/bubble.mp4" />
            </div>
            <div class="col">
              <img src="./figures/plasma.png">
            </div>
          </div>
        </section>

        <section>
          <div class="row">
            <div class="col-6">
              <img src="./figures/logo.png">
            </div>
            <div class="col-6 align-self-center text-end">
              <h1 class="title-talk">Samurai</h1>
              <a
                href="https://github.com/hpc-maths/samurai">https://github.com/hpc-maths/samurai</a>
            </div>
          </div>
        </section>

      </div>
    </div>
    <script type="module" src="/main.js"></script>

  </body>

</html>
